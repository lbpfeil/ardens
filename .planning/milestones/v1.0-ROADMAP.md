# Milestone v1.0: Arden FVS Mes 1 MVP

**Status:** SHIPPED 2026-01-24
**Phases:** 1-6 (+ 3 decimal insertions: 4.1, 5.1, 5.2)
**Total Plans:** 34

## Overview

Este roadmap cobre o Mes 1 do MVP do Arden FVS, focando na gestao de entidades do dominio (Obras, Agrupamentos, Unidades, Servicos) e no dashboard do engenheiro. A estrutura segue a hierarquia natural do modelo de dominio: Foundation para infraestrutura de forms/state, depois as entidades em ordem de dependencia (Obras > Agrupamentos > Unidades), Biblioteca FVS para servicos, e finalmente o Dashboard que consolida dados de todas as entidades.

## Phases

### Phase 1: Foundation
**Goal**: Infraestrutura de forms e state management configurada e pronta para uso em todas as features
**Depends on**: Nothing (first phase)
**Requirements**: INFR-01, INFR-02
**Plans**: 2 plans

Plans:
- [x] 01-01-PLAN.md — Zustand setup e primeiro store (app-store com UI state)
- [x] 01-02-PLAN.md — React Hook Form + Zod setup e form exemplo (ObraForm)

### Phase 2: Obras
**Goal**: Usuario pode gerenciar o ciclo completo de obras (criar, visualizar, editar, arquivar)
**Depends on**: Phase 1
**Requirements**: OBRA-01, OBRA-02, OBRA-03, OBRA-04, OBRA-05
**Plans**: 4 plans

Plans:
- [x] 02-01-PLAN.md — Setup: shadcn components, obra schema, data access layer
- [x] 02-02-PLAN.md — List page with table and create obra modal
- [x] 02-03-PLAN.md — Edit and archive obra functionality
- [x] 02-04-PLAN.md — Obra detail page

### Phase 3: Agrupamentos
**Goal**: Usuario pode gerenciar agrupamentos dentro de uma obra (blocos, torres, etc.)
**Depends on**: Phase 2
**Requirements**: AGRU-01, AGRU-02, AGRU-03, AGRU-04, AGRU-05
**Plans**: 4 plans

Plans:
- [x] 03-01-PLAN.md — Setup: data access layer, Zod schema, @dnd-kit installation
- [x] 03-02-PLAN.md — List page with table and create/edit modal with batch support
- [x] 03-03-PLAN.md — Delete confirmation and drag-and-drop reorder
- [x] 03-04-PLAN.md — Fix RLS policies for engenheiro access (gap closure)

### Phase 4: Unidades
**Goal**: Usuario pode gerenciar unidades dentro de agrupamentos (apartamentos, casas, etc.)
**Depends on**: Phase 3
**Requirements**: UNID-01, UNID-02, UNID-03, UNID-04, UNID-05
**Plans**: 4 plans

Plans:
- [x] 04-01-PLAN.md — Data access layer and validation schemas with numeric range batch
- [x] 04-02-PLAN.md — Split-view UI with unidades panel and CRUD modals
- [x] 04-03-PLAN.md — Fix RLS policies for engenheiro access (gap closure)
- [x] 04-04-PLAN.md — Fix PT-BR accents and dialog accessibility (gap closure)

### Phase 4.1: Navegacao Contextual (INSERTED)
**Goal**: Implementar sistema de navegacao contextual com sidebar global (visao geral) e sidebar de obra (contexto especifico), atualizando documentacao e integrando com features existentes
**Depends on**: Phase 4
**Requirements**: Derivado de 04_NAVIGATION.md (arquitetura de navegacao)
**Plans**: 4 plans

Plans:
- [x] 04.1-01-PLAN.md — Create navigation components (SidebarItem, SidebarGlobal, SidebarObra, Breadcrumb)
- [x] 04.1-02-PLAN.md — Rename route /agrupamentos to /unidades with redirect
- [x] 04.1-03-PLAN.md — Update layout for context-aware sidebar switching
- [x] 04.1-04-PLAN.md — Transform obra page to dashboard, create configuracoes page, update docs

### Phase 5: Biblioteca FVS
**Goal**: Usuario pode gerenciar biblioteca de servicos e ativar servicos por obra
**Depends on**: Phase 2 (precisa de obras para ativar servicos)
**Requirements**: SERV-01, SERV-02, SERV-03, SERV-04, SERV-05, SERV-06, SERV-07, SERV-08
**Plans**: 4 plans

Plans:
- [x] 05-01-PLAN.md — Setup: data access layer, validation schemas, navigation update
- [x] 05-02-PLAN.md — Biblioteca page with servicos table and CRUD modals
- [x] 05-03-PLAN.md — Servico detail page with itens de verificacao CRUD
- [x] 05-04-PLAN.md — Obra servicos activation page

### Phase 5.1: Revisoes de Servicos (INSERTED)
**Goal**: Implementar sistema de controle de revisoes para servicos FVS, permitindo rastrear mudancas e gerenciar atualizacoes por obra
**Depends on**: Phase 5
**Requirements**: REV-01, REV-02, REV-03, REV-04, REV-05
**Plans**: 4 plans

Plans:
- [x] 05.1-01-PLAN.md — Schema changes + data access layer for revisions
- [x] 05.1-02-PLAN.md — Service edit with revision increment and description
- [x] 05.1-03-PLAN.md — Revision history on service detail page
- [x] 05.1-04-PLAN.md — Obra revision tracking and update indicator

### Phase 5.2: Tags e Revisao Condicional (INSERTED)
**Goal**: Implementar tags para organizar itens de verificacao e tornar revisao condicional (apenas quando servico ja foi ativado)
**Depends on**: Phase 5.1
**Requirements**: REQ-01 a REQ-07
**Plans**: 5 plans

Plans:
- [x] 05.2-01-PLAN.md — Schema (tags table ordem, primeira_ativacao_em, tag_id em itens) + data access
- [x] 05.2-02-PLAN.md — Pagina de Tags com CRUD e reordenacao
- [x] 05.2-03-PLAN.md — Revisao condicional (logica + UI adaptativa)
- [x] 05.2-04-PLAN.md — Tags em itens (modal + tabela agrupada)
- [x] 05.2-05-PLAN.md — Drag-and-drop de itens entre tags

### Phase 6: Dashboard
**Goal**: Engenheiro tem visao consolidada da qualidade com KPIs e feed de nao-conformidades
**Depends on**: Phase 5.1 (precisa de todas entidades para calcular metricas)
**Requirements**: DASH-01, DASH-02, DASH-03, DASH-04, DASH-05, DASH-06
**Plans**: 3 plans

Plans:
- [x] 06-01-PLAN.md — Data access layer + KPI cards with trend indicators
- [x] 06-02-PLAN.md — NC feed with relative dates (date-fns)
- [x] 06-03-PLAN.md — Temporal chart (Recharts LineChart)

## Progress

**Execution Order:**
Phases execute in numeric order: 1 > 2 > 3 > 4 > 4.1 > 5 > 5.1 > 5.2 > 6

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 1. Foundation | 2/2 | Complete | 2026-01-19 |
| 2. Obras | 4/4 | Complete | 2026-01-19 |
| 3. Agrupamentos | 4/4 | Complete | 2026-01-20 |
| 4. Unidades | 4/4 | Complete | 2026-01-20 |
| 4.1. Navegacao Contextual | 4/4 | Complete | 2026-01-21 |
| 5. Biblioteca FVS | 4/4 | Complete | 2026-01-21 |
| 5.1. Revisoes de Servicos | 4/4 | Complete | 2026-01-22 |
| 5.2. Tags e Revisao Condicional | 5/5 | Complete | 2026-01-23 |
| 6. Dashboard | 3/3 | Complete | 2026-01-24 |

---

## Milestone Summary

**Decimal Phases:**
- Phase 4.1: Navegacao Contextual (inserted after Phase 4 for functional navigation)
- Phase 5.1: Revisoes de Servicos (inserted after Phase 5 for PBQP-H revision tracking)
- Phase 5.2: Tags e Revisao Condicional (inserted after Phase 5.1 for item organization)

**Key Decisions:**
- Hierarquia 2 niveis (Obra > Agrupamento > Unidade): Simplicidade e flexibilidade
- Biblioteca FVS por construtora: Cada construtora tem seus padroes
- Supabase como backend: RLS nativo elimina API layer
- createStore from zustand/vanilla: App Router per-request isolation
- Zod v3.x: RHF compatibility
- Server Component + Client Wrapper pattern: Pages with modals
- Revision stored as VARCHAR(5) with zero-padding: Sortability
- primeira_ativacao_em NULL = draft mode: Edits dont create revisions
- DashboardKPIs type with current/previous: Trend calculation

**Issues Resolved:**
- RLS policies missing for engenheiro role (Phase 3, 4 gap closures)
- PT-BR accents missing in UI texts (Phase 4 gap closure)
- Dialog accessibility warnings (Phase 4 gap closure)

**Technical Debt Incurred:**
- Hardcoded construtora name in breadcrumb.tsx (auth integration deferred)
- Hardcoded isOnline=true in status-indicator.tsx (network detection deferred)
- DEV_CLIENTE_ID constant instead of authenticated user (auth integration deferred)

---

*Roadmap created: 2026-01-19*
*Milestone shipped: 2026-01-24*
*Duration: 5 days*

---
_For current project status, see .planning/ROADMAP.md_
